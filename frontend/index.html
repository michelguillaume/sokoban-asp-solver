<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sokoban Puzzle - ASP Powered</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Inter:wght@300;400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="background-gradient"></div>

    <div class="container">
        <header class="game-header">
            <h1 class="game-title">
                <span class="title-icon">üéÆ</span>
                Sokoban
                <span class="subtitle">ASP-Powered Puzzle</span>
            </h1>
            <p class="game-description">Push all boxes to goal positions using intelligent AI hints!</p>
        </header>

        <div class="game-layout">
            <!-- Left Panel: Game Board -->
            <div class="game-board-container glass-panel">
                <div class="level-info">
                    <div class="info-item">
                        <span class="info-label">Level</span>
                        <span class="info-value" id="current-level">1</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Moves</span>
                        <span class="info-value" id="move-counter">0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Boxes</span>
                        <span class="info-value">
                            <span id="boxes-on-goals">0</span>/<span id="total-goals">0</span>
                        </span>
                    </div>
                </div>

                <div id="game-board" class="game-board"></div>

                <div class="solvability-indicator" id="solvability-indicator">
                    <div class="indicator-dot"></div>
                    <span class="indicator-text">Checking...</span>
                </div>
            </div>

            <!-- Right Panel: Controls -->
            <div class="controls-container glass-panel">
                <h2 class="controls-title">Game Controls</h2>

                <div class="controls-section">
                    <h3 class="section-title">Actions</h3>
                    <button class="btn btn-primary" id="hint-btn">
                        <span class="btn-icon">üí°</span>
                        Get Hint
                    </button>
                    <button class="btn btn-secondary" id="undo-btn">
                        <span class="btn-icon">‚Ü∂</span>
                        Undo Move
                    </button>
                    <button class="btn btn-secondary" id="reset-btn">
                        <span class="btn-icon">üîÑ</span>
                        Reset Level
                    </button>
                </div>

                <div class="controls-section">
                    <h3 class="section-title">Level Selection</h3>
                    <div class="level-selector" id="level-selector">
                        <!-- Levels will be added dynamically -->
                    </div>
                    <button class="btn btn-primary" id="random-level-btn" style="margin-top: 1rem;">
                        <span class="btn-icon">üé≤</span>
                        Random Level
                    </button>
                    <div id="random-difficulty" class="random-difficulty" style="margin-top: 0.5rem; display: none;">
                        <label
                            style="font-size: 0.9rem; color: var(--text-secondary); display: block; margin-bottom: 0.5rem;">Difficulty:</label>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn-diff" data-diff="1">Easy</button>
                            <button class="btn-diff active" data-diff="2">Medium</button>
                            <button class="btn-diff" data-diff="3">Hard</button>
                        </div>
                    </div>
                </div>

                <div class="controls-section">
                    <h3 class="section-title">How to Play</h3>
                    <div class="instructions">
                        <p><strong>Goal:</strong> Push all boxes üì¶ onto goal positions üéØ</p>
                        <p><strong>Controls:</strong> Use Arrow Keys or WASD to move</p>
                        <p><strong>Hint System:</strong> Click "Get Hint" for AI-powered suggestions</p>
                        <p><strong>Legend:</strong></p>
                        <ul class="legend">
                            <li><span class="legend-icon">üßç</span> Player</li>
                            <li><span class="legend-icon">üì¶</span> Box</li>
                            <li><span class="legend-icon">üéØ</span> Goal</li>
                            <li><span class="legend-icon">‚úÖ</span> Box on Goal</li>
                            <li><span class="legend-icon">üß±</span> Wall</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hint Display Modal -->
    <div class="hint-modal" id="hint-modal">
        <div class="hint-content">
            <div class="hint-icon">üí°</div>
            <p class="hint-message" id="hint-message"></p>
            <button class="btn btn-primary" id="hint-close">Got it!</button>
        </div>
    </div>

    <!-- Victory Modal -->
    <div class="victory-modal" id="victory-modal">
        <div class="victory-content">
            <div class="victory-animation">
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
            </div>
            <h2 class="victory-title">üéâ Level Complete! üéâ</h2>
            <p class="victory-stats">
                Completed in <span id="final-moves">0</span> moves!
            </p>
            <div class="victory-buttons">
                <button class="btn btn-primary" id="next-level-btn">Next Level</button>
                <button class="btn btn-secondary" id="replay-btn">Replay</button>
            </div>
        </div>
    </div>

    <!-- Unsolvable Alert Modal -->
    <div class="alert-modal" id="alert-modal">
        <div class="alert-content">
            <div class="alert-icon">‚ö†Ô∏è</div>
            <h2 class="alert-title">Puzzle Unsolvable!</h2>
            <p class="alert-message">The current state cannot lead to a solution. You may need to reset the level.</p>
            <button class="btn btn-primary" id="alert-close">OK</button>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="loading-text">Processing with ASP solver...</p>
    </div>

    <!-- Map Database Section -->
    <div class="card glass-panel" style="margin-top: 2rem; padding: 1.5rem;">
        <h2 class="controls-title" style="margin-bottom: 1rem;">üó∫Ô∏è Community Maps Database</h2>
        <p style="color: var(--text-secondary); margin-bottom: 1rem;">Play famous Sokoban maps and beat the best
            records!</p>
        <div id="map-db-list"
            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
            <!-- DB Maps inserted by JS -->
        </div>
    </div>

    <script src="js/levels.js"></script>
    <script src="js/map_database.js"></script>
    <script src="js/api.js"></script>
    <script src="js/game.js"></script>
</body>

</html>